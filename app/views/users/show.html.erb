<% 
	can_modify = (@user == current_user) 
	is_user_manager = current_user.is_user_manager_of?(@user)
	the_label = h(@user.name)
	content_for(:title, the_label)
%>

<%  %>

<div class="block">

  <%= render :partial => 'secondary_navigation' %>   

  <div class="content">
	<p>
		<b><%= link_to "", user_path(:id => @next), :class => 'previous_message' if @next %></b>
	</p>
	<p>
		<b><%= link_to "", user_path(:id => @previous), :class => 'next_message' if @previous %></b>
	</p>
	<br />
	
  <%= show_heading(the_label) %>
  
    <div class="inner">

	<!-- new table -->
		<table>
			<thead>

				<tr>
					<th colspan="2">

						<div class="description">
                          <span class="q">
								<%=sanitize @user.description.blank? ? control_label('description_no') : @user.description %>
							</span>
                        </div>


					</th>

				</tr>
			</thead>

			<tr>
				<td valign="top" width="105"><%= user_show_photo(@user, current_user) %></td>
				
				<td>
					<table border="1">
						
						<%= tr_td_action(:name, @user.name) %>
						<%= tr_td_action(:language, label_name(@user.language)) %>						
						
						<tr>
							<td class="label"><%= label_name(:groups) %></td>
							<td class="show"><%= @user.has_group? ? group_list(@user.groups) : label_name('groups_none') %></td>
						</tr>

						<%# if development? %>
						<!-- <tr>
							<td class="label"><%#= label_name(:tournaments) %></td>
							<td class="show"><%#= @user.has_tournament? ? tournament_list(@user.tournaments) : label_name('tournaments_none') %></td>
						</tr> -->
						<%# end -%>
						
						<%= tr_td_action(:time_zone, @user.time_zone) %>
						<%= tr_td_action(:phone, @user.phone) unless @user.private_phone %>
						<%= tr_td_action(:gender, label_name(@user.gender, 'value')) unless @user.gender.blank? %>			

						<% 
							the_label = h(label_name(@user.available, 'value'))
							the_confirmation = label_with_name('set_available', "#{@user.name}?") 
						%>			
						<tr>
							<%= content_tag :td, label_name(:available), :class => "label" %>
							<%= content_tag :td, 
									(is_user_manager ? link_to(the_label, set_available_path(:id => @user), 
													:confirm => the_confirmation) : the_label), 
													:class => get_the_action %>
						</tr>
						<% 
							the_label = h(label_name(@user.looking, 'value'))
							the_confirmation = label_with_name('looking_for_group', "#{@user.name}?") 
						%>
							<tr>
							  <%= content_tag :td, label_name(:looking_for_group), :class => "label" %>
							  <%= content_tag :td, 
									(@user == current_user ? link_to(the_label, set_user_looking_path(:id => @user), :confirm => the_confirmation) : the_label), 
									:class => get_the_action %>
							</tr>
						
						<% 
							the_label = h(label_name(@user.private_phone, 'value'))
							the_confirmation = label_with_name('set_private_phone', "#{@user.name}?") 
						%>
						<tr>
							<%= content_tag :td, label_name(:private_phone), :class => "label" %>
							<%= content_tag :td, (can_modify ? link_to(the_label, set_private_phone_path(:id => @user), 
													:confirm => the_confirmation) : the_label), 
													:class => get_the_action %>
						</tr>

						<% if @user.has_role?('manager') %>
						<%
							the_label = h(label_name(@user.teammate_notification, 'value'))
							the_confirmation = label_with_name('set_teammate_notification', "#{@user.name}?") 
						%>
						<tr>
							<%= content_tag :td, label_name(:teammate_notification), :class => "label" %>
							<%= content_tag :td, 
									(can_modify ? link_to(the_label, set_teammate_notification_path(:id => @user), 
												:confirm => the_confirmation) : the_label), 
												:class => get_the_action %>
						</tr>
						<% end %>
						
						<% 
							the_label = h(label_name(@user.message_notification, 'value'))
							the_confirmation = label_with_name('set_message_notification', "#{@user.name}?") 
						%>
						<tr>
							<%= content_tag :td, label_name(:message_notification), :class => "label" %>
							<%= content_tag :td, (can_modify ? link_to(the_label, set_message_notification_path(:id => @user), 
												:confirm => the_confirmation) : the_label), 
												:class => get_the_action %>
						</tr>

						<% 
							#the_label = h(label_name(@user.blog_comment_notification, 'value'))
							#the_confirmation = label_with_name('set_blog_comment_notification', "#{@user.name}?") 
						%>
						<!-- <tr>
							<%#= content_tag :td, label_name(:blog_comment_notification), :class => "label" %>
							<%#= content_tag :td, (can_modify ? link_to(the_label, set_blog_comment_notification_path(:id => @user), 
												:confirm => the_confirmation) : the_label), 
												:class => get_the_action %>
						</tr> -->
						
					</table>
					
				</td>
			</tr>
			
		</table>
	<!-- new table -->
	
		<%= render :partial => 'show_admin' if current_user.is_maximo? %>
  
    </div>
  </div>
</div>

<% content_for :sidebar, render(:partial => 'sidebar_show') -%>