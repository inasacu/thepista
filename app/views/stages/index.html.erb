<%= stylesheet_link_tag "in_place_styles"  %>
<% inplace_error_div %>

<%
	the_label = label_name(:stage)
	content_for(:title, the_label)
	is_manager = current_user.is_manager_of?(@cup)	
%>

<div class="block">

  <%= render :partial => '/cups/secondary_navigation' %>

  <div class="content">   
  
    <h2 class="title"><%= the_label %></h2>
	
    <div class="inner">
	
	<% if object_counter(@stages) > 0 %>
	
      <table class="table" id="<%= get_the_controller.gsub(' ','_') %>">
	  
        <tr> 
          <th class="first"><%#= label_name(:name) %></th>
          <th><%= label_name(:name) %></th>
          <th>&nbsp;</th>
          <th>&nbsp;</th>
		  <th align="center"><%= label_name(:matches) %></th>
          <th>&nbsp;</th>
          <th>&nbsp;</th>
          <th class="last">&nbsp;</th>
		</tr>
        
        <% @stages.each do |stage| 
			the_label = label_name(:stages_destroy)
			the_confirmation = "#{ the_label }?"
			@the_stage = stage  		
		-%>
        <tr>
	
          <td class="first">
			<%#= is_manager ? in_place_text_field(:the_stage, :name, {:cols => 1}) : stage.name %>
          </td>

          <td>
			<%= stage.name %>
          </td>

          <td>            
            <%= is_manager ? in_place_text_field(:the_stage, :home_ranking, {:cols => 1}) : stage.home_ranking %><br/>
	        <%= is_manager ? in_place_text_field(:the_stage, :home_stage_name, {:cols => 1}) : stage.home_stage_name %>
          </td>

          <td>
	      	<%= is_manager ? in_place_text_field(:the_stage, :away_ranking, {:cols => 1}) : stage.away_ranking %><br/>
		    <%= is_manager ? in_place_text_field(:the_stage, :away_stage_name, {:cols => 1}) : stage.away_stage_name %>
		  </td>
			
	       <td class="last">
				<% if current_user.is_manager_of?(@cup) %>
				<span class="action">					
					<%#= link_to label_name(:stages_edit), edit_stage_path(stage) %>
					<%#= link_to(the_label, stage_path(stage), :method => :delete, :confirm => the_confirmation) %>	
				</span>
				<% end -%>
	       </td>

        </tr>          
        <% end -%>
      </table>

	<%#= render :partial => 'shared/action_bar', :locals => { :collection => @stages } %>

		<% end %>
		
		</div>
		</div>
	</div>
	
<% content_for :sidebar, render(:partial => 'cups/sidebar_show') -%>

<%  if @cup  %>
<% content_for :sidebar, render(:partial => 'shared/share_object', :locals => {:cup => @cup}) -%>
<% content_for :sidebar, render(:partial => 'cups/sidebar_cup_additional', :locals => {:cup => @cup}) if current_user.is_manager_of?(@cup) -%>
<% content_for :sidebar, render(:partial => 'shared/sidebar_show_cup', :locals => {:cup => @cup}) if current_user.is_manager_of?(@cup) -%>
<% end -%>
