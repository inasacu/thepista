<h2 class="title"><%= get_collection_label(@cups) %></h2>

<div class="inner">
	
	<table class="table">

	  <tr>             
	    <th class="first">&nbsp;</th>
	    <th><%= label_name(:name) %></th>
	    <th><%= label_name(:time_zone) %></th>
	    <th><%= label_name(:general_information) %></th>
	    <th>&nbsp;</th>
	    <th class="last">&nbsp;</th>
	  </tr>

	  <% @cups.each do |cup| 
		the_final = Game.final_game(cup)
		final_played = the_final.played
	  -%>

	  <tr>  
			<td>
				<%= cup_image_link_small cup %>
			</td>

			<td class="name_and_date">
				<%= cup_link(cup) %><br />
				<span class="date">
				<%= cup.sport.name %>
				</span>
			</td>

			<td class="name_and_date">
				<%= nice_day_of_week(cup.starts_at) %><br />
				<span class="date">
				<%= has_left(cup.starts_at) if Time.zone.now < cup.starts_at %>
				</span>
			</td>

			<td class="name_and_date">
				<%= I18n.t(:has_cup_escuadras, :count => object_counter(cup.escuadras)) %><br />
				<span class="date">
				<%= I18n.t(:has_cup_games, :count => object_counter(cup.games)) %>
				</span>
			</td>

			<td class="name_and_date">
				<%= link_to(label_name(:standing), standing_path(:id => cup))  if object_counter(cup.standings) > 1 and !final_played %>
				<span class="date">
					<% if final_played %>
					<%#= the_final.home.name if (the_final.home_score.to_i > the_final.away_score.to_i) %>
					<%#= the_final.away.name if (the_final.home_score.to_i < the_final.away_score.to_i) %>
					<%= link_to(label_name(:final) , list_games_path(:id => cup)) %>
					<% end %>
				</span>
			</td>

	       <td class="last">
				<span class="action">
					<%= link_to label_name(:challenges_create), new_challenge_path(:id => cup) unless final_played %>
				
					<% if current_user.is_manager_of?(cup) %>
					 	<br/>
						<%= link_to label_name(:games_create), new_game_path(:id => cup)  %><br/>
						<%= link_to label_name(:escuadras_create), new_escuadra_path(:id => cup)  %>
			        <% end %>
					
				</span>
	       </td>
	  </tr>   
 
	  <% end -%>

	</table>	
	
	<%= render :partial => 'shared/action_bar', :locals => { :collection => @cups } %>

</div>