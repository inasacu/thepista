<h2 class="title"><%= get_collection_label(@groups) %></h2>

<div class="inner">
	
	<table class="table">

	  <tr>             
	    <th class="first">&nbsp;</th>
	    <th><%= label_name(:name) %>&nbsp;/<br />
			  <%= label_name(:gameday_at) %></th>
	    <th><%= label_name(:manager) %>&nbsp;/<br />
			  <%= label_name(:sport) %></th>
	    <th><%= label_name(:time_zone) %></th>
	    <th><%= label_name(:general_information) %></th>
	    <th><%= label_name(:last_game_played) %></th>
	    <th class="last">&nbsp;</th>
	  </tr>

	  <% @groups.each do |group| 
		schedule = Schedule.last_schedule_group_played(group)
		-%>

	  <tr>  
			<td>
				<%= group_image_link_small group %>
			</td>

			<td class="name_and_date">
				<%= group_link(group) %>
				<span class="date">
					<%= nice_day_time group.gameday_at %>
				</span>
			</td>

			<td>
				<%= user_list group.all_the_managers %><br />
				<%= group.sport.name %>
			</td>

			<td>
				<%= group.time_zone %>
			</td>

			<td>
				<%= I18n.t(:has_group_users, :count => object_counter(group.users)) %><br />
				<%= I18n.t(:has_group_schedules, :count => object_counter(group.schedules)) %>
			</td>

			<td class="name_and_date">
				<%= link_to(label_name(:scorecard), scorecard_path(:id => group)) %>
				<span class="date">
					<%= nice_full_date(schedule.starts_at) unless schedule.nil? %> 
				</span>
			</td>

	       <td class="last">
				<span class="action">
					<% if current_user.is_member_of?(group) %>
						<%= link_to(label_name(:send_message_to_group), new_message_path(:group_id => group)) %><br />
					<% else %>
						<%= link_to(label_name(:send_message_to_group), new_message_path(:id => group.all_the_managers.first)) %><br />
				
					<% 	# unless current_user.has_pending_petition?(current_user) 
						unless current_user.has_group_petition?(current_user, group) 
							the_label = label_with_name('add_to_group', group.name)
							the_confirmation = "#{ label_name(:petition_to_join_group) } #{current_user.name} #{ label_name(:to) } #{group.name}?"
					%> 
							<%= link_to(the_label, join_team_path(:id => group, :teammate => current_user), :confirm => the_confirmation) %>
					<% 	end 
					   end
					-%>
				
					<% if current_user.is_manager_of?(group) %> 
						<%= link_to label_name(:schedules_create), new_schedule_path(:id => group)  %><br />
			        <% end %>
					
				</span>
	       </td>
	  </tr>   
 
	  <% end -%>

	</table>	
	
	<%= render :partial => 'shared/action_bar', :locals => { :collection => @groups } %>

</div>