creating matches and scorecards related to particular sport


schedules_controller.rb

def create
...
	@schedule.create_schedule_details(current_user)
...
end


schedule.rb
def create_schedule_details(user, update_schedule=false)
...
  Match.create_schedule_match(self)
...
end


match.rb
# create a record in the match table for teammates in group team
def self.create_schedule_match(schedule)
  schedule.group.users.each do |user|
    type_id = 3     # set to ausente

    self.create!(:name => schedule.concept, :schedule_id => schedule.id, :group_id => schedule.group_id, 
                :user_id => user.id, :available => user.available, 
                :type_id => type_id, :played => schedule.played) if self.schedule_group_user_exists?(schedule, user)
  end
end

scorecard.rb
# record if user and group do not exist
def self.create_user_scorecard(user, group)
  self.create!(:group_id => group.id, :user_id => user.id) if self.user_group_exists?(user, group)
end

